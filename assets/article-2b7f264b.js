import{d as Q,r as u,a as X,b as Z,J as ee,c as C,w as i,v as a,u as e,e as l,f as t,G as te,H as oe,g as p,i as k,o as $,t as E,j as H,k as se,l as ne,m as ie,n as N,$ as R,p as Y,z as ae,h as le,q as re,s as ce}from"./symbols-2aef84fb.js";import{a as de}from"./imgs-6e30657b.js";import{n as O,a as ue,r as pe}from"./variable-a4637b51.js";import{t as fe}from"./throttle-5cadf59e.js";import{C as P,_ as me}from"./index-d7ccc6e4.js";import{_ as _e}from"./index.vue_vue_type_script_setup_true_lang-a463ac3c.js";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang-60c3ca11.js";import{L as he}from"./index-cde9dc1e.js";import{u as ge}from"./use-media-7b12d379.js";import{s as we,A as ye,H as be}from"./index-a57d630f.js";const xe={class:"wrapper"},Ce={class:"article-container"},ke={class:"ignore-title-author"},$e={class:"ignore-title"},He={class:"ignore-author"},Se={class:"flex-between-start content-container"},De={class:"flex-column-between-start ignore-des-link"},Le={class:"ignore-des"},Te=["href"],Me={"aspect-ratio":"",class:"ignore-article-img"},Ue=["src"],Ae={class:"ignore-check"},Be=t("p",{class:"ignore-remind"},"请填写姓名，然后进行人脸拍照，提交审核通过后即可通过输入姓名访问",-1),Ke={class:"ignore-visitor"},ze={class:"ignore-face-area"},Ie={class:"flex-double-center media-border"},Ve={id:"video",width:"240",height:"180",autoplay:""},Ee={id:"canvas",width:"240",height:"180"},Ne={class:"flex-between-center ignore-snap"},Oe={class:"flex-between-center ignore-btn-area"},Pe=Q({__name:"index",setup(Re){let r=1;const f=7;let S=!1,h=0;const{visitor:g,action:c,operator:j,snap:D,handleCancel:W,handleSubmit:q,handleCheck:L,getMedia:T,takePhoto:M,cancelSnap:U,confirmSnap:A,computedWidth:w}=ge(),B=k(R),K=k(Y),y=k(ae),z=u([]),m=u([]),_=u(!0),b=u(!1),I=u(null),F=async()=>{if(B&&K){const n=await K.get(B.getArticleList);z.value=n.data.articleList.reverse(),m.value=n.data.articleList.slice((r-1)*f,r*f)}};X(()=>{F()}),Z(()=>{window.onscroll=fe(G,1e3),_.value=!1,h=window.pageYOffset}),ee(()=>{I.value=null});const G=()=>{const n=window.pageYOffset,s=n-h;if(h=n,s<=0)return!1;if(!S){const d=Math.max(document.body.scrollHeight,document.body.offsetHeight),o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,x=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;if(d-o-x<50){r+=1;const V=z.value.slice((r-1)*f,r*f);if(V.length==0){S=!0,y==null||y("列表已经全部加载完成");return}_.value=!0,I.value=window.setTimeout(()=>{_.value=!1,m.value=[...m.value,...V]},500)}}},J=n=>{const s="target="+new Date().getTime()+"_"+n.id+"_"+n.title+"_"+n.author,d=window.btoa(window.encodeURIComponent(s));return`${pe("article_read")}?${d}`};return(n,s)=>{const d=le("dompurify-html");return $(),C("div",xe,[i(l(e(_e),{"nav-default-list":e(O),onCallCheckId:s[0]||(s[0]=o=>b.value=!0)},null,8,["nav-default-list"]),[[a,e(w)]]),t("div",Ce,[($(!0),C(te,null,oe(m.value,(o,x)=>($(),C("section",{key:`article-item-${x}`,class:"flex-column-around-start ignore-article-item"},[t("div",ke,[t("h2",$e,E(o.title),1),t("p",He,"作者："+E(o.author),1)]),t("div",Se,[t("div",De,[i(t("div",Le,null,512),[[d,o.description]]),t("a",{class:"ignore-read-more",href:J(o)},"阅读全文 >>",8,Te)]),t("div",Me,[t("img",{src:`${e(de).path}${o.id}.png`,class:"aspect-ratio-img",alt:"配文图片"},null,8,Ue)])])]))),128))]),i(l(e(he),null,null,512),[[a,_.value]]),l(e(me),{visible:b.value,"show-close":"",width:"500px",onClose:s[7]||(s[7]=o=>b.value=!1)},{title:p(()=>[H(" 身份验证 ")]),footer:p(()=>[t("div",Oe,[l(e(P),{type:"ghost",onClick:e(W)},{default:p(()=>[H("取消")]),_:1},8,["onClick"]),l(e(P),{type:"primary",onClick:e(q)},{default:p(()=>[H("提交")]),_:1},8,["onClick"])])]),default:p(()=>[t("div",Ae,[Be,t("div",Ke,[i(t("input",{id:"name","onUpdate:modelValue":s[1]||(s[1]=o=>ne(g)?g.value=o:null),type:"text",placeholder:"点击输入姓名",onKeyup:s[2]||(s[2]=ie(re((...o)=>e(L)&&e(L)(...o),["exact"]),["enter"]))},null,544),[[se,e(g),void 0,{lazy:!0}]])]),t("div",ze,[i(t("i",{class:"iconfont icon-camera1 ignore-face-btn",title:"开启摄像头",onClick:s[3]||(s[3]=(...o)=>e(T)&&e(T)(...o))},null,512),[[a,!e(D)]]),t("div",Ie,[i(t("video",Ve,null,512),[[a,!e(c)]]),i(t("canvas",Ee,null,512),[[a,e(c)]])]),i(t("div",Ne,[t("i",{class:"iconfont icon-fanhui ignore-snap-cancel",style:N({opacity:e(c)?1:""}),title:"重新拍摄",onClick:s[4]||(s[4]=(...o)=>e(U)&&e(U)(...o))},null,4),i(t("i",{class:"iconfont icon-ios-radio-button-on ignore-snap-action",title:"点击拍照",onClick:s[5]||(s[5]=(...o)=>e(M)&&e(M)(...o))},null,512),[[a,!e(c)]]),t("i",{class:"iconfont icon-duihao ignore-snap-confirm",style:N({opacity:e(c)?1:""}),title:"确认使用",onClick:s[6]||(s[6]=(...o)=>e(A)&&e(A)(...o))},null,4)],512),[[a,e(D)&&!e(j)]])])])]),_:1},8,["visible"]),i(l(e(ve),{"nav-list":e(O)},null,8,["nav-list"]),[[a,!e(w)]]),l(e(ue),{"is-mobile":!e(w)},null,8,["is-mobile"])])}}});const v=ce(Pe);we(v);v.provide(R,ye);v.provide(Y,be);v.mount("#app");
