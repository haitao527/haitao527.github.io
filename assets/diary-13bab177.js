import{d as O,r as f,a as V,b as j,K as F,c as r,w as p,v as g,u as n,e as _,f as s,F as N,G as k,o as l,t as S,h as P,i as w,$ as K,m as Y,y as U,q as W}from"./symbols-a5750b6c.js";import{c as B,n as A,t as q,a as z}from"./variable-24519989.js";import{t as G}from"./throttle-5cadf59e.js";import{_ as I}from"./index.vue_vue_type_script_setup_true_lang-4be7f323.js";import{_ as J}from"./index.vue_vue_type_script_setup_true_lang-62a30e59.js";import{L as Q}from"./index-5811b485.js";import{u as R}from"./use-media-c867db85.js";import{s as X,A as Z,H as ee}from"./index-10f78ce3.js";const te={class:"ignore-diary-container"},oe={class:"flex-double-center ignore-time-line-container"},ne=["onClick"],se={class:"ignore-time-line-text"},ie=s("span",{class:"ignore-time-line-space"}," ",-1),ae={class:"ignore-section-container"},re={class:"ignore-date"},le={class:"ignore-mood"},ce=["src"],de=["innerHTML"],me=O({__name:"index",setup(ue){let i=1;const c=7;let b=!1,v=0;const H=w(K),$=w(Y),y=w(U),x=f([]),d=f([]),m=f(!0),D=f(null),{computedWidth:u}=R(),L=async t=>{if($&&H){const o=await $.get(H[`getDiary${t}`]);x.value=o.data.articleList.reverse(),d.value=o.data.articleList.slice((i-1)*c,i*c)}},C=()=>{const t=window.pageYOffset,o=t-v;if(v=t,o<=0)return!1;if(!b){const e=Math.max(document.body.scrollHeight,document.body.offsetHeight),a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,T=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;if(e-a-T<50){i+=1;const M=x.value.slice((i-1)*c,i*c);if(M.length==0){b=!0,y==null||y("列表已经全部加载完成");return}m.value=!0,D.value=window.setTimeout(()=>{m.value=!1,d.value=[...d.value,...M]},500)}}},E=t=>{let o;const e=t.title.split("/");return Number(e[0])>2016||Number(e[0])==2016&&(Number(e[1])>8||Number(e[1])==8&&Number(e[2])>=28)?o="/img/face/"+t.mood+".gif":o="/img/imgmood/"+t.mood+".png",o};return V(()=>{L(B)}),j(()=>{window.onscroll=G(C,1e3),m.value=!1,v=window.pageYOffset}),F(()=>{D.value=null}),(t,o)=>(l(),r("div",te,[p(_(n(I),{"nav-default-list":n(A)},null,8,["nav-default-list"]),[[g,n(u)]]),p(s("ul",oe,[(l(!0),r(N,null,k(n(q),(e,a)=>(l(),r("li",{key:`time-${a}`,class:"ignore-time-line-item",onClick:T=>L(e)},[s("span",se,S(e),1),ie],8,ne))),128))],512),[[g,n(u)]]),s("div",ae,[(l(!0),r(N,null,k(d.value,(e,a)=>(l(),r("section",{key:`diary-item-${a}`,class:"flex-column-around-start ignore-diary-item"},[s("h2",re,S(e.title),1),s("p",le,[P("此刻心情："),s("img",{src:E(e),alt:"心情emoji"},null,8,ce)]),s("div",{class:"ignore-diary-content",innerHTML:e.content},null,8,de)]))),128))]),p(_(n(Q),null,null,512),[[g,m.value]]),p(_(n(J),{"nav-list":n(A)},null,8,["nav-list"]),[[g,!n(u)]]),_(n(z),{year:n(B),"is-mobile":!n(u)},null,8,["year","is-mobile"])]))}});const h=W(me);X(h);h.provide(K,Z);h.provide(Y,ee);h.mount("#app");
