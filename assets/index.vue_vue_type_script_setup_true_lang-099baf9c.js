import{d as y,r as d,C as B,b as S,o as _,c as k,f as V,E as A}from"./symbols-2aef84fb.js";const E={id:"musicWrapper"},b=["width","height"],D=y({__name:"index",props:{play:{type:Boolean},width:null,height:null,color:null,link:null},emits:["switchoff"],setup(l,{emit:C}){const h=l,f=d(new AudioContext),n=d(null),c=d(null);return B(()=>{var a,o;h.play?(f.value.resume(),(a=n.value)==null||a.play()):(o=n.value)==null||o.pause()}),S(()=>{var p,v,m;n.value=document.querySelector("#audio"),c.value=document.querySelector("#canvasVoice"),n.value&&(n.value.onended=function(){C("switchoff")});const a=window.AudioContext,o=f.value=new a,x=o.createMediaElementSource(n.value),s=o.createScriptProcessor(4096,1,1),u=((p=c.value)==null?void 0:p.width)??1368,i=((v=c.value)==null?void 0:v.height)??200,t=(m=c.value)==null?void 0:m.getContext("2d");t.strokeStyle=h.color||"#aaa",t==null||t.translate(.5,i/2+.5),x.connect(s),s.connect(o.destination),s.onaudioprocess=function(w){const g=w.inputBuffer.getChannelData(0),r=w.outputBuffer.getChannelData(0);for(let e=0;e<g.length;e++)r[e]=g[e];t.clearRect(-.5,-i/2-.5,u,i),t.beginPath();for(let e=0;e<u;e++)t.lineTo(e,i/2*r[r.length*e/u|0]);t.stroke()}}),(a,o)=>(_(),k("div",E,[V("canvas",{id:"canvasVoice",width:l.width,height:l.height},null,8,b),A(a.$slots,"default")]))}});export{D as _};
