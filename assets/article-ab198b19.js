import{d as Q,r as u,a as X,b as Z,J as ee,c as C,w as i,v as a,u as e,e as l,f as t,G as te,H as oe,g as p,i as k,o as $,t as E,j as H,k as se,l as ne,m as ie,n as N,$ as R,p as Y,z as ae,h as le,q as re,s as ce}from"./symbols-2aef84fb.js";import{y as de}from"./vue-dompurify-html-d8dd7e5d.js";import{a as ue}from"./imgs-6e30657b.js";import{n as O,a as pe,r as me}from"./variable-a4637b51.js";import{t as fe}from"./throttle-5cadf59e.js";import{C as P,_ as _e}from"./index-d7ccc6e4.js";import{_ as ve}from"./index.vue_vue_type_script_setup_true_lang-a463ac3c.js";import{_ as he}from"./index.vue_vue_type_script_setup_true_lang-60c3ca11.js";import{L as ge}from"./index-cde9dc1e.js";import{u as we}from"./use-media-7b12d379.js";import{s as ye,A as be,H as xe}from"./index-9a522eb6.js";const Ce={class:"wrapper"},ke={class:"article-container"},$e={class:"ignore-title-author"},He={class:"ignore-title"},Se={class:"ignore-author"},De={class:"flex-between-start content-container"},Le={class:"flex-column-between-start ignore-des-link"},Te={class:"ignore-des"},Me=["href"],Ue={"aspect-ratio":"",class:"ignore-article-img"},Ae=["src"],Be={class:"ignore-check"},Ke=t("p",{class:"ignore-remind"},"请填写姓名，然后进行人脸拍照，提交审核通过后即可通过输入姓名访问",-1),ze={class:"ignore-visitor"},Ie={class:"ignore-face-area"},Ve={class:"flex-double-center media-border"},Ee={id:"video",width:"240",height:"180",autoplay:""},Ne={id:"canvas",width:"240",height:"180"},Oe={class:"flex-between-center ignore-snap"},Pe={class:"flex-between-center ignore-btn-area"},Re=Q({__name:"index",setup(Ye){let r=1;const f=7;let S=!1,h=0;const{visitor:g,action:c,operator:j,snap:D,handleCancel:W,handleSubmit:q,handleCheck:L,getMedia:T,takePhoto:M,cancelSnap:U,confirmSnap:A,computedWidth:w}=we(),B=k(R),K=k(Y),y=k(ae),z=u([]),_=u([]),v=u(!0),b=u(!1),I=u(null),F=async()=>{if(B&&K){const n=await K.get(B.getArticleList);z.value=n.data.articleList.reverse(),_.value=n.data.articleList.slice((r-1)*f,r*f)}};X(()=>{F()}),Z(()=>{window.onscroll=fe(G,1e3),v.value=!1,h=window.pageYOffset}),ee(()=>{I.value=null});const G=()=>{const n=window.pageYOffset,s=n-h;if(h=n,s<=0)return!1;if(!S){const d=Math.max(document.body.scrollHeight,document.body.offsetHeight),o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0,x=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;if(d-o-x<50){r+=1;const V=z.value.slice((r-1)*f,r*f);if(V.length==0){S=!0,y==null||y("列表已经全部加载完成");return}v.value=!0,I.value=window.setTimeout(()=>{v.value=!1,_.value=[..._.value,...V]},500)}}},J=n=>{const s="target="+new Date().getTime()+"_"+n.id+"_"+n.title+"_"+n.author,d=window.btoa(window.encodeURIComponent(s));return`${me("article_read")}?${d}`};return(n,s)=>{const d=le("dompurify-html");return $(),C("div",Ce,[i(l(e(ve),{"nav-default-list":e(O),onCallCheckId:s[0]||(s[0]=o=>b.value=!0)},null,8,["nav-default-list"]),[[a,e(w)]]),t("div",ke,[($(!0),C(te,null,oe(_.value,(o,x)=>($(),C("section",{key:`article-item-${x}`,class:"flex-column-around-start ignore-article-item"},[t("div",$e,[t("h2",He,E(o.title),1),t("p",Se,"作者："+E(o.author),1)]),t("div",De,[t("div",Le,[i(t("div",Te,null,512),[[d,o.description]]),t("a",{class:"ignore-read-more",href:J(o)},"阅读全文 >>",8,Me)]),t("div",Ue,[t("img",{src:`${e(ue).path}${o.id}.png`,class:"aspect-ratio-img",alt:"配文图片"},null,8,Ae)])])]))),128))]),i(l(e(ge),null,null,512),[[a,v.value]]),l(e(_e),{visible:b.value,"show-close":"",width:"500px",onClose:s[7]||(s[7]=o=>b.value=!1)},{title:p(()=>[H(" 身份验证 ")]),footer:p(()=>[t("div",Pe,[l(e(P),{type:"ghost",onClick:e(W)},{default:p(()=>[H("取消")]),_:1},8,["onClick"]),l(e(P),{type:"primary",onClick:e(q)},{default:p(()=>[H("提交")]),_:1},8,["onClick"])])]),default:p(()=>[t("div",Be,[Ke,t("div",ze,[i(t("input",{id:"name","onUpdate:modelValue":s[1]||(s[1]=o=>ne(g)?g.value=o:null),type:"text",placeholder:"点击输入姓名",onKeyup:s[2]||(s[2]=ie(re((...o)=>e(L)&&e(L)(...o),["exact"]),["enter"]))},null,544),[[se,e(g),void 0,{lazy:!0}]])]),t("div",Ie,[i(t("i",{class:"iconfont icon-camera1 ignore-face-btn",title:"开启摄像头",onClick:s[3]||(s[3]=(...o)=>e(T)&&e(T)(...o))},null,512),[[a,!e(D)]]),t("div",Ve,[i(t("video",Ee,null,512),[[a,!e(c)]]),i(t("canvas",Ne,null,512),[[a,e(c)]])]),i(t("div",Oe,[t("i",{class:"iconfont icon-fanhui ignore-snap-cancel",style:N({opacity:e(c)?1:""}),title:"重新拍摄",onClick:s[4]||(s[4]=(...o)=>e(U)&&e(U)(...o))},null,4),i(t("i",{class:"iconfont icon-ios-radio-button-on ignore-snap-action",title:"点击拍照",onClick:s[5]||(s[5]=(...o)=>e(M)&&e(M)(...o))},null,512),[[a,!e(c)]]),t("i",{class:"iconfont icon-duihao ignore-snap-confirm",style:N({opacity:e(c)?1:""}),title:"确认使用",onClick:s[6]||(s[6]=(...o)=>e(A)&&e(A)(...o))},null,4)],512),[[a,e(D)&&!e(j)]])])])]),_:1},8,["visible"]),i(l(e(he),{"nav-list":e(O)},null,8,["nav-list"]),[[a,!e(w)]]),l(e(pe),{"is-mobile":!e(w)},null,8,["is-mobile"])])}}});const m=ce(Re);ye(m);m.use(de);m.provide(R,be);m.provide(Y,xe);m.mount("#app");
